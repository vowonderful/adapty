const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export function moduleData(){return{inject:["uipData","router","uipress","uiTemplate","unsavedChanges"],data:function(){return{history:{states:[],index:0},ui:{strings:{undo:__("Undo","uipress-lite"),redo:__("Redo","uipress-lite"),historyStates:__("History states","uipress-lite")}}}},watch:{"history.index":{handler(t,i){this.changehistoryState(t)},deep:!0}},mounted:function(){let t=this,i=JSON.parse(JSON.stringify(t.uiTemplate.content));t.logHistoryState(__("Project opened","uipress-lite"),i,i),document.addEventListener("uip_builder_history_change",i=>{t.unsavedChanges=!0,t.logHistoryState(i.detail.type,i.detail.oldTemplate,i.detail.newTemplate)},{once:!1}),document.addEventListener("keydown",this.handleKeyCombination)},beforeDestroy(){document.removeEventListener("keydown",this.handleKeyCombination)},computed:{returnHistoryStates(){return this.history.states}},methods:{handleKeyCombination(){const t=event.metaKey||event.ctrlKey,i=event.shiftKey,e=90===event.which;t&&e&&!i&&this.historyBackward(),t&&e&&i&&this.historyForward()},changehistoryState(t){let i=this.history.states[t].template;this.uiTemplate.content=i},logHistoryState(t,i,e){let n=this.history.states;var s=new Date;let r=s.getHours()+":"+String(s.getMinutes()).padStart(2,"0");0==e&&(e=JSON.parse(JSON.stringify(this.uiTemplate.content)));let o={name:t,time:r,template:e};n.splice(0,0,o),n.length>10&&n.pop(),this.history.index=0,this.history.states=n},historyBackward(){return this.history.index<this.history.states.length-1&&(this.history.index+=1,!0)},historyForward(){return this.history.index>0&&(this.history.index=this.history.index-1,!0)}},template:'\n    \n      <div class="uip-flex uip-gap-xxs uip-flex-center uip-background-muted uip-border-rounder uip-padding-xs uip-padding-top-xxs uip-padding-bottom-xxs">\n  \t\t\t<div :title="ui.strings.undo" \n        @click="historyBackward()" class="hover:uip-background-muted uip-border-round uip-flex uip-flex-center  uip-icon uip-link-default uip-text-xl uip-ratio-1-1 uip-line-height-1 uip-icon-medium" :class="{\'uip-text-muted\' : history.index == history.states.length - 1 || history.states.length == 0}">\n\t\t\t\tundo\n  \t\t\t</div>\n        \n  \t\t\t<div :title="ui.strings.redo" \n        @click="historyForward()" class="hover:uip-background-muted uip-border-round uip-flex uip-flex-center  uip-icon uip-link-default uip-text-xl uip-ratio-1-1 uip-line-height-1 uip-icon-medium" \n  \t\t\t:class="{\'uip-text-muted\' : history.index < 1 || history.states.length == 0}">\n\t\t\t\tredo\n  \t\t\t</div>\n        \n        <div class="uip-border-right uip-h-18 uip-margin0-left-xxs uip-margin-right-xxs"></div>\n        \n  \t\t  <drop-down dropPos="bottom-left" :title="ui.strings.historyStates">\n\t\t\t\t  <template v-slot:trigger>\n\t  \t\t\t\t  <div :title="ui.strings.historyStates" \n              class="hover:uip-background-muted uip-border-round uip-flex uip-flex-center  uip-icon uip-link-default uip-text-xl uip-ratio-1-1 uip-line-height-1 uip-icon-medium">\n\t\t\t\t\t\t  history\n\t  \t\t\t\t  </div>\n\t\t\t\t  </template>\n\t\t\t\t  <template v-slot:content>\n\t  \t\t\t\t  <div class="uip-flex uip-flex-column uip-row-gap-xs uip-padding-s uip-min-w-200" dropPos="bottom-left">\n\t\t\t\t\t\t  <div class="uip-text-bold">{{ui.strings.historyStates}}</div>\n\t\t\t\t\t\t  <template v-for="(state, index) in returnHistoryStates">\n\t\t  \t\t\t\t\t  <div @click="history.index = index" class="uip-background-muted uip-border-round uip-padding-xxs uip-flex uip-flex-column uip-cursor-pointer hover:uip-background-grey" :class="{\'uip-background-primary-wash\' :index == history.index}">\n\t\t\t\t\t\t\t\t  <div>{{state.name}}</div>\n\t\t\t\t\t\t\t\t  <div class="uip-text-muted uip-text-xs">{{state.time}}</div>\n\t\t  \t\t\t\t\t  </div>\n\t\t\t\t\t\t  </template>\n\t  \t\t\t\t  </div>\n\t\t\t\t  </template>\n  \t\t  </drop-down>\n      </div>  \n\t  \t'}};